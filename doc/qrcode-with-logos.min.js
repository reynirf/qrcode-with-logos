!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).QrCodeWithLogo=e()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function t(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function e(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function n(t){return"string"==typeof t}var r=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};let o;const i=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];var s={getSymbolSize:function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},getSymbolTotalCodewords:function(t){return i[t]},getBCHDigit:function(t){let e=0;for(;0!==t;)e++,t>>>=1;return e},setToSJISFunction:function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');o=t},isKanjiModeEnabled:function(){return void 0!==o},toSJIS:function(t){return o(t)}};function a(t,e){return t(e={exports:{}},e.exports),e.exports}var u=a((function(t,e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return n}}}));function f(){this.buffer=[],this.length=0}u.L,u.M,u.Q,u.H,u.isValid,f.prototype={get:function(t){const e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(let n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var c=f;function h(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}h.prototype.set=function(t,e,n,r){const o=t*this.size+e;this.data[o]=n,r&&(this.reservedBit[o]=!0)},h.prototype.get=function(t,e){return this.data[t*this.size+e]},h.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n},h.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var l=h,g=a((function(t,e){const n=s.getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];const e=Math.floor(t/7)+2,r=n(t),o=145===r?26:2*Math.ceil((r-13)/(2*e-2)),i=[r-7];for(let t=1;t<e-1;t++)i[t]=i[t-1]-o;return i.push(6),i.reverse()},e.getPositions=function(t){const n=[],r=e.getRowColCoords(t),o=r.length;for(let t=0;t<o;t++)for(let e=0;e<o;e++)0===t&&0===e||0===t&&e===o-1||t===o-1&&0===e||n.push([r[t],r[e]]);return n}}));g.getRowColCoords,g.getPositions;const d=s.getSymbolSize;var p={getPositions:function(t){const e=d(t);return[[0,0],[e-7,0],[0,e-7]]}},w=a((function(t,e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n=3,r=3,o=40,i=10;function s(t,n,r){switch(t){case e.Patterns.PATTERN000:return(n+r)%2==0;case e.Patterns.PATTERN001:return n%2==0;case e.Patterns.PATTERN010:return r%3==0;case e.Patterns.PATTERN011:return(n+r)%3==0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case e.Patterns.PATTERN101:return n*r%2+n*r%3==0;case e.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case e.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){const e=t.size;let r=0,o=0,i=0,s=null,a=null;for(let u=0;u<e;u++){o=i=0,s=a=null;for(let f=0;f<e;f++){let e=t.get(u,f);e===s?o++:(o>=5&&(r+=n+(o-5)),s=e,o=1),e=t.get(f,u),e===a?i++:(i>=5&&(r+=n+(i-5)),a=e,i=1)}o>=5&&(r+=n+(o-5)),i>=5&&(r+=n+(i-5))}return r},e.getPenaltyN2=function(t){const e=t.size;let n=0;for(let r=0;r<e-1;r++)for(let o=0;o<e-1;o++){const e=t.get(r,o)+t.get(r,o+1)+t.get(r+1,o)+t.get(r+1,o+1);4!==e&&0!==e||n++}return n*r},e.getPenaltyN3=function(t){const e=t.size;let n=0,r=0,i=0;for(let o=0;o<e;o++){r=i=0;for(let s=0;s<e;s++)r=r<<1&2047|t.get(o,s),s>=10&&(1488===r||93===r)&&n++,i=i<<1&2047|t.get(s,o),s>=10&&(1488===i||93===i)&&n++}return n*o},e.getPenaltyN4=function(t){let e=0;const n=t.data.length;for(let r=0;r<n;r++)e+=t.data[r];return Math.abs(Math.ceil(100*e/n/5)-10)*i},e.applyMask=function(t,e){const n=e.size;for(let r=0;r<n;r++)for(let o=0;o<n;o++)e.isReserved(o,r)||e.xor(o,r,s(t,o,r))},e.getBestMask=function(t,n){const r=Object.keys(e.Patterns).length;let o=0,i=1/0;for(let s=0;s<r;s++){n(s),e.applyMask(s,t);const r=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(s,t),r<i&&(i=r,o=s)}return o}}));w.Patterns,w.isValid,w.getPenaltyN1,w.getPenaltyN2,w.getPenaltyN3,w.getPenaltyN4,w.applyMask,w.getBestMask;const y=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],v=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];var m={getBlocksCount:function(t,e){switch(e){case u.L:return y[4*(t-1)+0];case u.M:return y[4*(t-1)+1];case u.Q:return y[4*(t-1)+2];case u.H:return y[4*(t-1)+3];default:return}},getTotalCodewordsCount:function(t,e){switch(e){case u.L:return v[4*(t-1)+0];case u.M:return v[4*(t-1)+1];case u.Q:return v[4*(t-1)+2];case u.H:return v[4*(t-1)+3];default:return}}};const E=new Uint8Array(512),A=new Uint8Array(256);!function(){let t=1;for(let e=0;e<255;e++)E[e]=t,A[t]=e,t<<=1,256&t&&(t^=285);for(let t=255;t<512;t++)E[t]=E[t-255]}();var b=function(t){return E[t]},T=function(t,e){return 0===t||0===e?0:E[A[t]+A[e]]},R=a((function(t,e){e.mul=function(t,e){const n=new Uint8Array(t.length+e.length-1);for(let r=0;r<t.length;r++)for(let o=0;o<e.length;o++)n[r+o]^=T(t[r],e[o]);return n},e.mod=function(t,e){let n=new Uint8Array(t);for(;n.length-e.length>=0;){const t=n[0];for(let r=0;r<e.length;r++)n[r]^=T(e[r],t);let r=0;for(;r<n.length&&0===n[r];)r++;n=n.slice(r)}return n},e.generateECPolynomial=function(t){let n=new Uint8Array([1]);for(let r=0;r<t;r++)n=e.mul(n,new Uint8Array([1,b(r)]));return n}}));function P(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}R.mul,R.mod,R.generateECPolynomial,P.prototype.initialize=function(t){this.degree=t,this.genPoly=R.generateECPolynomial(this.degree)},P.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=R.mod(e,this.genPoly),r=this.degree-n.length;if(r>0){const t=new Uint8Array(this.degree);return t.set(n,r),t}return n};var C=P,B=function(t){return!isNaN(t)&&t>=1&&t<=40};const I="[0-9]+";let M="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";M=M.replace(/u/g,"\\u");const U="(?:(?![A-Z0-9 $%*+\\-./:]|"+M+")(?:.|[\r\n]))+";var S=new RegExp(M,"g"),_=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),L=new RegExp(U,"g"),N=new RegExp(I,"g"),x=new RegExp("[A-Z $%*+\\-./:]+","g");const D=new RegExp("^"+M+"$"),Y=new RegExp("^"+I+"$"),O=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");var k={KANJI:S,BYTE_KANJI:_,BYTE:L,NUMERIC:N,ALPHANUMERIC:x,testKanji:function(t){return D.test(t)},testNumeric:function(t){return Y.test(t)},testAlphanumeric:function(t){return O.test(t)}},F=a((function(t,e){e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!B(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return k.testNumeric(t)?e.NUMERIC:k.testAlphanumeric(t)?e.ALPHANUMERIC:k.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return n}}}));F.NUMERIC,F.ALPHANUMERIC,F.BYTE,F.KANJI,F.MIXED,F.getCharCountIndicator,F.getBestModeForData,F.isValid;var z=a((function(t,e){const n=s.getBCHDigit(7973);function r(t,e){return F.getCharCountIndicator(t,e)+4}function o(t,e){let n=0;return t.forEach((function(t){const o=r(t.mode,e);n+=o+t.getBitsLength()})),n}e.from=function(t,e){return B(t)?parseInt(t,10):e},e.getCapacity=function(t,e,n){if(!B(t))throw new Error("Invalid QR Code version");void 0===n&&(n=F.BYTE);const o=8*(s.getSymbolTotalCodewords(t)-m.getTotalCodewordsCount(t,e));if(n===F.MIXED)return o;const i=o-r(n,t);switch(n){case F.NUMERIC:return Math.floor(i/10*3);case F.ALPHANUMERIC:return Math.floor(i/11*2);case F.KANJI:return Math.floor(i/13);case F.BYTE:default:return Math.floor(i/8)}},e.getBestVersionForData=function(t,n){let r;const i=u.from(n,u.M);if(Array.isArray(t)){if(t.length>1)return function(t,n){for(let r=1;r<=40;r++)if(o(t,r)<=e.getCapacity(r,n,F.MIXED))return r}(t,i);if(0===t.length)return 1;r=t[0]}else r=t;return function(t,n,r){for(let o=1;o<=40;o++)if(n<=e.getCapacity(o,r,t))return o}(r.mode,r.getLength(),i)},e.getEncodedBits=function(t){if(!B(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;s.getBCHDigit(e)-n>=0;)e^=7973<<s.getBCHDigit(e)-n;return t<<12|e}}));z.getCapacity,z.getBestVersionForData,z.getEncodedBits;const H=s.getBCHDigit(1335);var j={getEncodedBits:function(t,e){const n=t.bit<<3|e;let r=n<<10;for(;s.getBCHDigit(r)-H>=0;)r^=1335<<s.getBCHDigit(r)-H;return 21522^(n<<10|r)}};function J(t){this.mode=F.NUMERIC,this.data=t.toString()}J.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},J.prototype.getLength=function(){return this.data.length},J.prototype.getBitsLength=function(){return J.getBitsLength(this.data.length)},J.prototype.write=function(t){let e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);const o=this.data.length-e;o>0&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,3*o+1))};var W=J;const K=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function q(t){this.mode=F.ALPHANUMERIC,this.data=t}q.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},q.prototype.getLength=function(){return this.data.length},q.prototype.getBitsLength=function(){return q.getBitsLength(this.data.length)},q.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let n=45*K.indexOf(this.data[e]);n+=K.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(K.indexOf(this.data[e]),6)};var V=q,Q=function(t){for(var e=[],n=t.length,r=0;r<n;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319&&n>r+1){var i=t.charCodeAt(r+1);i>=56320&&i<=57343&&(o=1024*(o-55296)+i-56320+65536,r+=1)}o<128?e.push(o):o<2048?(e.push(o>>6|192),e.push(63&o|128)):o<55296||o>=57344&&o<65536?(e.push(o>>12|224),e.push(o>>6&63|128),e.push(63&o|128)):o>=65536&&o<=1114111?(e.push(o>>18|240),e.push(o>>12&63|128),e.push(o>>6&63|128),e.push(63&o|128)):e.push(239,191,189)}return new Uint8Array(e).buffer};function $(t){this.mode=F.BYTE,"string"==typeof t&&(t=Q(t)),this.data=new Uint8Array(t)}$.getBitsLength=function(t){return 8*t},$.prototype.getLength=function(){return this.data.length},$.prototype.getBitsLength=function(){return $.getBitsLength(this.data.length)},$.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)};var G=$;function Z(t){this.mode=F.KANJI,this.data=t}Z.getBitsLength=function(t){return 13*t},Z.prototype.getLength=function(){return this.data.length},Z.prototype.getBitsLength=function(){return Z.getBitsLength(this.data.length)},Z.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=s.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13)}};var X=Z,tt=a((function(t){var e={single_source_shortest_paths:function(t,n,r){var o={},i={};i[n]=0;var s,a,u,f,c,h,l,g=e.PriorityQueue.make();for(g.push(n,0);!g.empty();)for(u in a=(s=g.pop()).value,f=s.cost,c=t[a]||{})c.hasOwnProperty(u)&&(h=f+c[u],l=i[u],(void 0===i[u]||l>h)&&(i[u]=h,g.push(u,h),o[u]=a));if(void 0!==r&&void 0===i[r]){var d=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(d)}return o},extract_shortest_path_from_predecessor_list:function(t,e){for(var n=[],r=e;r;)n.push(r),r=t[r];return n.reverse(),n},find_path:function(t,n,r){var o=e.single_source_shortest_paths(t,n,r);return e.extract_shortest_path_from_predecessor_list(o,r)},PriorityQueue:{make:function(t){var n,r=e.PriorityQueue,o={};for(n in t=t||{},r)r.hasOwnProperty(n)&&(o[n]=r[n]);return o.queue=[],o.sorter=t.sorter||r.default_sorter,o},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var n={value:t,cost:e};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e})),et=a((function(t,e){function n(t){return unescape(encodeURIComponent(t)).length}function r(t,e,n){const r=[];let o;for(;null!==(o=t.exec(n));)r.push({data:o[0],index:o.index,mode:e,length:o[0].length});return r}function o(t){const e=r(k.NUMERIC,F.NUMERIC,t),n=r(k.ALPHANUMERIC,F.ALPHANUMERIC,t);let o,i;s.isKanjiModeEnabled()?(o=r(k.BYTE,F.BYTE,t),i=r(k.KANJI,F.KANJI,t)):(o=r(k.BYTE_KANJI,F.BYTE,t),i=[]);return e.concat(n,o,i).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function i(t,e){switch(e){case F.NUMERIC:return W.getBitsLength(t);case F.ALPHANUMERIC:return V.getBitsLength(t);case F.KANJI:return X.getBitsLength(t);case F.BYTE:return G.getBitsLength(t)}}function a(t,e){let n;const r=F.getBestModeForData(t);if(n=F.from(e,r),n!==F.BYTE&&n.bit<r.bit)throw new Error('"'+t+'" cannot be encoded with mode '+F.toString(n)+".\n Suggested mode is: "+F.toString(r));switch(n!==F.KANJI||s.isKanjiModeEnabled()||(n=F.BYTE),n){case F.NUMERIC:return new W(t);case F.ALPHANUMERIC:return new V(t);case F.KANJI:return new X(t);case F.BYTE:return new G(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(a(e,null)):e.data&&t.push(a(e.data,e.mode)),t}),[])},e.fromString=function(t,r){const s=function(t){const e=[];for(let r=0;r<t.length;r++){const o=t[r];switch(o.mode){case F.NUMERIC:e.push([o,{data:o.data,mode:F.ALPHANUMERIC,length:o.length},{data:o.data,mode:F.BYTE,length:o.length}]);break;case F.ALPHANUMERIC:e.push([o,{data:o.data,mode:F.BYTE,length:o.length}]);break;case F.KANJI:e.push([o,{data:o.data,mode:F.BYTE,length:n(o.data)}]);break;case F.BYTE:e.push([{data:o.data,mode:F.BYTE,length:n(o.data)}])}}return e}(o(t)),a=function(t,e){const n={},r={start:{}};let o=["start"];for(let s=0;s<t.length;s++){const a=t[s],u=[];for(let t=0;t<a.length;t++){const f=a[t],c=""+s+t;u.push(c),n[c]={node:f,lastCount:0},r[c]={};for(let t=0;t<o.length;t++){const s=o[t];n[s]&&n[s].node.mode===f.mode?(r[s][c]=i(n[s].lastCount+f.length,f.mode)-i(n[s].lastCount,f.mode),n[s].lastCount+=f.length):(n[s]&&(n[s].lastCount=f.length),r[s][c]=i(f.length,f.mode)+4+F.getCharCountIndicator(f.mode,e))}}o=u}for(let t=0;t<o.length;t++)r[o[t]].end=0;return{map:r,table:n}}(s,r),u=tt.find_path(a.map,"start","end"),f=[];for(let t=1;t<u.length-1;t++)f.push(a.table[u[t]].node);return e.fromArray(function(t){return t.reduce((function(t,e){const n=t.length-1>=0?t[t.length-1]:null;return n&&n.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[])}(f))},e.rawSplit=function(t){return e.fromArray(o(t))}}));function nt(t,e,n){const r=t.size,o=j.getEncodedBits(e,n);let i,s;for(i=0;i<15;i++)s=1==(o>>i&1),i<6?t.set(i,8,s,!0):i<8?t.set(i+1,8,s,!0):t.set(r-15+i,8,s,!0),i<8?t.set(8,r-i-1,s,!0):i<9?t.set(8,15-i-1+1,s,!0):t.set(8,15-i-1,s,!0);t.set(r-8,8,1,!0)}function rt(t,e,n){const r=new c;n.forEach((function(e){r.put(e.mode.bit,4),r.put(e.getLength(),F.getCharCountIndicator(e.mode,t)),e.write(r)}));const o=8*(s.getSymbolTotalCodewords(t)-m.getTotalCodewordsCount(t,e));for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(0);const i=(o-r.getLengthInBits())/8;for(let t=0;t<i;t++)r.put(t%2?17:236,8);return function(t,e,n){const r=s.getSymbolTotalCodewords(e),o=m.getTotalCodewordsCount(e,n),i=r-o,a=m.getBlocksCount(e,n),u=r%a,f=a-u,c=Math.floor(r/a),h=Math.floor(i/a),l=h+1,g=c-h,d=new C(g);let p=0;const w=new Array(a),y=new Array(a);let v=0;const E=new Uint8Array(t.buffer);for(let t=0;t<a;t++){const e=t<f?h:l;w[t]=E.slice(p,p+e),y[t]=d.encode(w[t]),p+=e,v=Math.max(v,e)}const A=new Uint8Array(r);let b,T,R=0;for(b=0;b<v;b++)for(T=0;T<a;T++)b<w[T].length&&(A[R++]=w[T][b]);for(b=0;b<g;b++)for(T=0;T<a;T++)A[R++]=y[T][b];return A}(r,t,e)}function ot(t,e,n,r){let o;if(Array.isArray(t))o=et.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");{let r=e;if(!r){const e=et.rawSplit(t);r=z.getBestVersionForData(e,n)}o=et.fromString(t,r||40)}}const i=z.getBestVersionForData(o,n);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<i)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+i+".\n")}else e=i;const a=rt(e,n,o),u=s.getSymbolSize(e),f=new l(u);return function(t,e){const n=t.size,r=p.getPositions(e);for(let e=0;e<r.length;e++){const o=r[e][0],i=r[e][1];for(let e=-1;e<=7;e++)if(!(o+e<=-1||n<=o+e))for(let r=-1;r<=7;r++)i+r<=-1||n<=i+r||(e>=0&&e<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===e||6===e)||e>=2&&e<=4&&r>=2&&r<=4?t.set(o+e,i+r,!0,!0):t.set(o+e,i+r,!1,!0))}}(f,e),function(t){const e=t.size;for(let n=8;n<e-8;n++){const e=n%2==0;t.set(n,6,e,!0),t.set(6,n,e,!0)}}(f),function(t,e){const n=g.getPositions(e);for(let e=0;e<n.length;e++){const r=n[e][0],o=n[e][1];for(let e=-2;e<=2;e++)for(let n=-2;n<=2;n++)-2===e||2===e||-2===n||2===n||0===e&&0===n?t.set(r+e,o+n,!0,!0):t.set(r+e,o+n,!1,!0)}}(f,e),nt(f,n,0),e>=7&&function(t,e){const n=t.size,r=z.getEncodedBits(e);let o,i,s;for(let e=0;e<18;e++)o=Math.floor(e/3),i=e%3+n-8-3,s=1==(r>>e&1),t.set(o,i,s,!0),t.set(i,o,s,!0)}(f,e),function(t,e){const n=t.size;let r=-1,o=n-1,i=7,s=0;for(let a=n-1;a>0;a-=2)for(6===a&&a--;;){for(let n=0;n<2;n++)if(!t.isReserved(o,a-n)){let r=!1;s<e.length&&(r=1==(e[s]>>>i&1)),t.set(o,a-n,r),i--,-1===i&&(s++,i=7)}if(o+=r,o<0||n<=o){o-=r,r=-r;break}}}(f,a),isNaN(r)&&(r=w.getBestMask(f,nt.bind(null,f,n))),w.applyMask(r,f),nt(f,n,r),{modules:f,version:e,errorCorrectionLevel:n,maskPattern:r,segments:o}}et.fromArray,et.fromString,et.rawSplit;var it={create:function(t,e){if(void 0===t||""===t)throw new Error("No input text");let n,r,o=u.M;return void 0!==e&&(o=u.from(e.errorCorrectionLevel,u.M),n=z.from(e.version),r=w.from(e.maskPattern),e.toSJISFunc&&s.setToSJISFunction(e.toSJISFunc)),ot(t,n,o,r)}},st="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},at=[],ut=[],ft="undefined"!=typeof Uint8Array?Uint8Array:Array,ct=!1;function ht(){ct=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)at[e]=t[e],ut[t.charCodeAt(e)]=e;ut["-".charCodeAt(0)]=62,ut["_".charCodeAt(0)]=63}function lt(t,e,n){for(var r,o,i=[],s=e;s<n;s+=3)r=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(at[(o=r)>>18&63]+at[o>>12&63]+at[o>>6&63]+at[63&o]);return i.join("")}function gt(t){var e;ct||ht();for(var n=t.length,r=n%3,o="",i=[],s=16383,a=0,u=n-r;a<u;a+=s)i.push(lt(t,a,a+s>u?u:a+s));return 1===r?(e=t[n-1],o+=at[e>>2],o+=at[e<<4&63],o+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],o+=at[e>>10],o+=at[e>>4&63],o+=at[e<<2&63],o+="="),i.push(o),i.join("")}function dt(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,f=u>>1,c=-7,h=n?o-1:0,l=n?-1:1,g=t[e+h];for(h+=l,i=g&(1<<-c)-1,g>>=-c,c+=a;c>0;i=256*i+t[e+h],h+=l,c-=8);for(s=i&(1<<-c)-1,i>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=l,c-=8);if(0===i)i=1-f;else{if(i===u)return s?NaN:1/0*(g?-1:1);s+=Math.pow(2,r),i-=f}return(g?-1:1)*s*Math.pow(2,i-r)}function pt(t,e,n,r,o,i){var s,a,u,f=8*i-o-1,c=(1<<f)-1,h=c>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,d=r?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?l/u:l*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+g]=255&a,g+=d,a/=256,o-=8);for(s=s<<o|a,f+=o;f>0;t[n+g]=255&s,g+=d,s/=256,f-=8);t[n+g-d]|=128*p}var wt={}.toString,yt=Array.isArray||function(t){return"[object Array]"==wt.call(t)};function vt(){return Et.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function mt(t,e){if(vt()<e)throw new RangeError("Invalid typed array length");return Et.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Et.prototype:(null===t&&(t=new Et(e)),t.length=e),t}function Et(t,e,n){if(!(Et.TYPED_ARRAY_SUPPORT||this instanceof Et))return new Et(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return Tt(this,t)}return At(this,t,e,n)}function At(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);Et.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Et.prototype:t=Rt(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!Et.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|Bt(e,n);t=mt(t,r);var o=t.write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(Ct(e)){var n=0|Pt(e.length);return 0===(t=mt(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?mt(t,0):Rt(t,e);if("Buffer"===e.type&&yt(e.data))return Rt(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function bt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Tt(t,e){if(bt(e),t=mt(t,e<0?0:0|Pt(e)),!Et.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function Rt(t,e){var n=e.length<0?0:0|Pt(e.length);t=mt(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function Pt(t){if(t>=vt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+vt().toString(16)+" bytes");return 0|t}function Ct(t){return!(null==t||!t._isBuffer)}function Bt(t,e){if(Ct(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return te(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ee(t).length;default:if(r)return te(t).length;e=(""+e).toLowerCase(),r=!0}}function It(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return jt(this,e,n);case"utf8":case"utf-8":return kt(this,e,n);case"ascii":return zt(this,e,n);case"latin1":case"binary":return Ht(this,e,n);case"base64":return Ot(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Jt(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function Mt(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function Ut(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=Et.from(e,r)),Ct(e))return 0===e.length?-1:St(t,e,n,r,o);if("number"==typeof e)return e&=255,Et.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):St(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function St(t,e,n,r,o){var i,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function f(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var c=-1;for(i=n;i<a;i++)if(f(t,i)===f(e,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===u)return c*s}else-1!==c&&(i-=i-c),c=-1}else for(n+u>a&&(n=a-u),i=n;i>=0;i--){for(var h=!0,l=0;l<u;l++)if(f(t,i+l)!==f(e,l)){h=!1;break}if(h)return i}return-1}function _t(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function Lt(t,e,n,r){return ne(te(e,t.length-n),t,n,r)}function Nt(t,e,n,r){return ne(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function xt(t,e,n,r){return Nt(t,e,n,r)}function Dt(t,e,n,r){return ne(ee(e),t,n,r)}function Yt(t,e,n,r){return ne(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function Ot(t,e,n){return 0===e&&n===t.length?gt(t):gt(t.slice(e,n))}function kt(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,a,u,f=t[o],c=null,h=f>239?4:f>223?3:f>191?2:1;if(o+h<=n)switch(h){case 1:f<128&&(c=f);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&f)<<6|63&i)>127&&(c=u);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(u=(15&f)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&f)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),o+=h}return function(t){var e=t.length;if(e<=Ft)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Ft));return n}(r)}Et.TYPED_ARRAY_SUPPORT=void 0===st.TYPED_ARRAY_SUPPORT||st.TYPED_ARRAY_SUPPORT,Et.poolSize=8192,Et._augment=function(t){return t.__proto__=Et.prototype,t},Et.from=function(t,e,n){return At(null,t,e,n)},Et.TYPED_ARRAY_SUPPORT&&(Et.prototype.__proto__=Uint8Array.prototype,Et.__proto__=Uint8Array),Et.alloc=function(t,e,n){return function(t,e,n,r){return bt(e),e<=0?mt(t,e):void 0!==n?"string"==typeof r?mt(t,e).fill(n,r):mt(t,e).fill(n):mt(t,e)}(null,t,e,n)},Et.allocUnsafe=function(t){return Tt(null,t)},Et.allocUnsafeSlow=function(t){return Tt(null,t)},Et.isBuffer=function(t){return null!=t&&(!!t._isBuffer||re(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&re(t.slice(0,0))}(t))},Et.compare=function(t,e){if(!Ct(t)||!Ct(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},Et.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Et.concat=function(t,e){if(!yt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Et.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=Et.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(!Ct(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},Et.byteLength=Bt,Et.prototype._isBuffer=!0,Et.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Mt(this,e,e+1);return this},Et.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Mt(this,e,e+3),Mt(this,e+1,e+2);return this},Et.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Mt(this,e,e+7),Mt(this,e+1,e+6),Mt(this,e+2,e+5),Mt(this,e+3,e+4);return this},Et.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?kt(this,0,t):It.apply(this,arguments)},Et.prototype.equals=function(t){if(!Ct(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Et.compare(this,t)},Et.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},Et.prototype.compare=function(t,e,n,r,o){if(!Ct(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(i,s),u=this.slice(r,o),f=t.slice(e,n),c=0;c<a;++c)if(u[c]!==f[c]){i=u[c],s=f[c];break}return i<s?-1:s<i?1:0},Et.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},Et.prototype.indexOf=function(t,e,n){return Ut(this,t,e,n,!0)},Et.prototype.lastIndexOf=function(t,e,n){return Ut(this,t,e,n,!1)},Et.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _t(this,t,e,n);case"utf8":case"utf-8":return Lt(this,t,e,n);case"ascii":return Nt(this,t,e,n);case"latin1":case"binary":return xt(this,t,e,n);case"base64":return Dt(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Yt(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},Et.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ft=4096;function zt(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function Ht(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function jt(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=Xt(t[i]);return o}function Jt(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function Wt(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Kt(t,e,n,r,o,i){if(!Ct(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function qt(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function Vt(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function Qt(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function $t(t,e,n,r,o){return o||Qt(t,0,n,4),pt(t,e,n,r,23,4),n+4}function Gt(t,e,n,r,o){return o||Qt(t,0,n,8),pt(t,e,n,r,52,8),n+8}Et.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),Et.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=Et.prototype;else{var o=e-t;n=new Et(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},Et.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||Wt(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},Et.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||Wt(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},Et.prototype.readUInt8=function(t,e){return e||Wt(t,1,this.length),this[t]},Et.prototype.readUInt16LE=function(t,e){return e||Wt(t,2,this.length),this[t]|this[t+1]<<8},Et.prototype.readUInt16BE=function(t,e){return e||Wt(t,2,this.length),this[t]<<8|this[t+1]},Et.prototype.readUInt32LE=function(t,e){return e||Wt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Et.prototype.readUInt32BE=function(t,e){return e||Wt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Et.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||Wt(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},Et.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||Wt(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},Et.prototype.readInt8=function(t,e){return e||Wt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Et.prototype.readInt16LE=function(t,e){e||Wt(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},Et.prototype.readInt16BE=function(t,e){e||Wt(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},Et.prototype.readInt32LE=function(t,e){return e||Wt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Et.prototype.readInt32BE=function(t,e){return e||Wt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Et.prototype.readFloatLE=function(t,e){return e||Wt(t,4,this.length),dt(this,t,!0,23,4)},Et.prototype.readFloatBE=function(t,e){return e||Wt(t,4,this.length),dt(this,t,!1,23,4)},Et.prototype.readDoubleLE=function(t,e){return e||Wt(t,8,this.length),dt(this,t,!0,52,8)},Et.prototype.readDoubleBE=function(t,e){return e||Wt(t,8,this.length),dt(this,t,!1,52,8)},Et.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Kt(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},Et.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Kt(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},Et.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,1,255,0),Et.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Et.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,2,65535,0),Et.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):qt(this,t,e,!0),e+2},Et.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,2,65535,0),Et.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):qt(this,t,e,!1),e+2},Et.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,4,4294967295,0),Et.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Vt(this,t,e,!0),e+4},Et.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,4,4294967295,0),Et.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Vt(this,t,e,!1),e+4},Et.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);Kt(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},Et.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);Kt(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},Et.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,1,127,-128),Et.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Et.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,2,32767,-32768),Et.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):qt(this,t,e,!0),e+2},Et.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,2,32767,-32768),Et.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):qt(this,t,e,!1),e+2},Et.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,4,2147483647,-2147483648),Et.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Vt(this,t,e,!0),e+4},Et.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Kt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Et.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Vt(this,t,e,!1),e+4},Et.prototype.writeFloatLE=function(t,e,n){return $t(this,t,e,!0,n)},Et.prototype.writeFloatBE=function(t,e,n){return $t(this,t,e,!1,n)},Et.prototype.writeDoubleLE=function(t,e,n){return Gt(this,t,e,!0,n)},Et.prototype.writeDoubleBE=function(t,e,n){return Gt(this,t,e,!1,n)},Et.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!Et.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},Et.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Et.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=Ct(t)?t:te(new Et(t,r).toString()),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var Zt=/[^+\/0-9A-Za-z-_]/g;function Xt(t){return t<16?"0"+t.toString(16):t.toString(16)}function te(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function ee(t){return function(t){var e,n,r,o,i,s;ct||ht();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===t[a-2]?2:"="===t[a-1]?1:0,s=new ft(3*a/4-i),r=i>0?a-4:a;var u=0;for(e=0,n=0;e<r;e+=4,n+=3)o=ut[t.charCodeAt(e)]<<18|ut[t.charCodeAt(e+1)]<<12|ut[t.charCodeAt(e+2)]<<6|ut[t.charCodeAt(e+3)],s[u++]=o>>16&255,s[u++]=o>>8&255,s[u++]=255&o;return 2===i?(o=ut[t.charCodeAt(e)]<<2|ut[t.charCodeAt(e+1)]>>4,s[u++]=255&o):1===i&&(o=ut[t.charCodeAt(e)]<<10|ut[t.charCodeAt(e+1)]<<4|ut[t.charCodeAt(e+2)]>>2,s[u++]=o>>8&255,s[u++]=255&o),s}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Zt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function ne(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function re(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}const oe=require("fs"),ie=require("pngjs").PNG,se=require("./utils");exports.render=function(t,e){const n=se.getOptions(e),r=n.rendererOpts,o=se.getImageWidth(t.modules.size,n);r.width=o,r.height=o;const i=new ie(r);return se.qrToImageData(i.data,t,n),i},exports.renderToDataURL=function(t,e,n){void 0===n&&(n=e,e=void 0),exports.renderToBuffer(t,e,(function(t,e){t&&n(t);let r="data:image/png;base64,";r+=e.toString("base64"),n(null,r)}))},exports.renderToBuffer=function(t,e,n){void 0===n&&(n=e,e=void 0);const r=exports.render(t,e),o=[];r.on("error",n),r.on("data",(function(t){o.push(t)})),r.on("end",(function(){n(null,Et.concat(o))})),r.pack()},exports.renderToFile=function(t,e,n,r){void 0===r&&(r=n,n=void 0);let o=!1;const i=(...t)=>{o||(o=!0,r.apply(null,t))},s=oe.createWriteStream(t);s.on("error",i),s.on("close",i),exports.renderToFileStream(s,e,n)},exports.renderToFileStream=function(t,e,n){exports.render(e,n).pack().pipe(t)};var ae=Object.freeze({__proto__:null}),ue=a((function(t,e){function n(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");let e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");const n=parseInt(e.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});const e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,o=t.scale||4;return{width:r,scale:r?4:o,margin:e,color:{dark:n(t.color.dark||"#000000ff"),light:n(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,n){const r=e.getScale(t,n);return Math.floor((t+2*n.margin)*r)},e.qrToImageData=function(t,n,r){const o=n.modules.size,i=n.modules.data,s=e.getScale(o,r),a=Math.floor((o+2*r.margin)*s),u=r.margin*s,f=[r.color.light,r.color.dark];for(let e=0;e<a;e++)for(let n=0;n<a;n++){let c=4*(e*a+n),h=r.color.light;if(e>=u&&n>=u&&e<a-u&&n<a-u){h=f[i[Math.floor((e-u)/s)*o+Math.floor((n-u)/s)]?1:0]}t[c++]=h.r,t[c++]=h.g,t[c++]=h.b,t[c]=h.a}}}));ue.getOptions,ue.getScale,ue.getImageWidth,ue.qrToImageData;var fe={},ce=a((function(t,e){const n={WW:" ",WB:"â–„",BB:"â–ˆ",BW:"â–€"},r={BB:" ",BW:"â–„",WW:"â–ˆ",WB:"â–€"};function o(t,e,n){return t&&e?n.BB:t&&!e?n.BW:!t&&e?n.WB:n.WW}e.render=function(t,e,i){const s=ue.getOptions(e);let a=n;"#ffffff"!==s.color.dark.hex&&"#000000"!==s.color.light.hex||(a=r);const u=t.modules.size,f=t.modules.data;let c="",h=Array(u+2*s.margin+1).join(a.WW);h=Array(s.margin/2+1).join(h+"\n");const l=Array(s.margin+1).join(a.WW);c+=h;for(let t=0;t<u;t+=2){c+=l;for(let e=0;e<u;e++){c+=o(f[t*u+e],f[(t+1)*u+e],a)}c+=l+"\n"}return c+=h.slice(0,-1),"function"==typeof i&&i(null,c),c},e.renderToFile=function(t,n,r,o){void 0===o&&(o=r,r=void 0);const i=fe,s=e.render(n,r);i.writeFile(t,s,o)}}));ce.render,ce.renderToFile;var he=function(t,e,n){const r=t.modules.size,o=t.modules.data,i="[47m  [0m";let s="";const a=Array(r+3).join(i),u=Array(2).join(i);s+=a+"\n";for(let t=0;t<r;++t){s+=i;for(let e=0;e<r;e++)s+=o[t*r+e]?"[40m  [0m":i;s+=u+"\n"}return s+=a+"\n","function"==typeof n&&n(null,s),s};const le="[37m",ge="[30m",de="[0m",pe="[47m"+ge,we="[40m"+le,ye=function(t,e,n,r){const o=e+1;if(n>=o||r>=o||r<-1||n<-1)return"0";if(n>=e||r>=e||r<0||n<0)return"1";return t[r*e+n]?"2":"1"},ve=function(t,e,n,r){return ye(t,e,n,r)+ye(t,e,n,r+1)};var me=function(t,e,n){const r=t.modules.size,o=t.modules.data,i=!(!e||!e.inverse),s=e&&e.inverse?we:pe,a=function(t,e,n){return{"00":de+" "+t,"01":de+e+"â–„"+t,"02":de+n+"â–„"+t,10:de+e+"â–€"+t,11:" ",12:"â–„",20:de+n+"â–€"+t,21:"â–€",22:"â–ˆ"}}(s,i?ge:le,i?le:ge),u=de+"\n"+s;let f=s;for(let t=-1;t<r+1;t+=2){for(let e=-1;e<r;e++)f+=a[ve(o,r,e,t)];f+=a[ve(o,r,r,t)]+u}return f+=de,"function"==typeof n&&n(null,f),f},Ee={render:function(t,e,n){return e&&e.small?me(t,e,n):he(t,e,n)}};function Ae(t,e){const n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function be(t,e,n){let r=t+e;return void 0!==n&&(r+=" "+n),r}var Te=function(t,e,n){const r=ue.getOptions(e),o=t.modules.size,i=t.modules.data,s=o+2*r.margin,a=r.color.light.a?"<path "+Ae(r.color.light,"fill")+' d="M0 0h'+s+"v"+s+'H0z"/>':"",u="<path "+Ae(r.color.dark,"stroke")+' d="'+function(t,e,n){let r="",o=0,i=!1,s=0;for(let a=0;a<t.length;a++){const u=Math.floor(a%e),f=Math.floor(a/e);u||i||(i=!0),t[a]?(s++,a>0&&u>0&&t[a-1]||(r+=i?be("M",u+n,.5+f+n):be("m",o,0),o=0,i=!1),u+1<e&&t[a+1]||(r+=be("h",s),s=0)):o++}return r}(i,o,r.margin)+'"/>',f='viewBox="0 0 '+s+" "+s+'"',c='<svg xmlns="http://www.w3.org/2000/svg" '+(r.width?'width="'+r.width+'" height="'+r.width+'" ':"")+f+' shape-rendering="crispEdges">'+a+u+"</svg>\n";return"function"==typeof n&&n(null,c),c},Re=a((function(t,e){e.render=Te,e.renderToFile=function(t,n,r,o){void 0===o&&(o=r,r=void 0);const i=fe,s='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+e.render(n,r);i.writeFile(t,s,o)}}));Re.render,Re.renderToFile;var Pe=a((function(t,e){e.render=function(t,e,n){let r=n,o=e;void 0!==r||e&&e.getContext||(r=e,e=void 0),e||(o=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),r=ue.getOptions(r);const i=ue.getImageWidth(t.modules.size,r),s=o.getContext("2d"),a=s.createImageData(i,i);return ue.qrToImageData(a.data,t,r),function(t,e,n){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=n,e.width=n,e.style.height=n+"px",e.style.width=n+"px"}(s,o,i),s.putImageData(a,0,0),o},e.renderToDataURL=function(t,n,r){let o=r;void 0!==o||n&&n.getContext||(o=n,n=void 0),o||(o={});const i=e.render(t,n,o),s=o.type||"image/png",a=o.rendererOpts||{};return i.toDataURL(s,a.quality)}}));function Ce(t,e,n,o,i){const s=[].slice.call(arguments,1),a=s.length,u="function"==typeof s[a-1];if(!u&&!r())throw new Error("Callback required as last argument");if(!u){if(a<1)throw new Error("Too few arguments provided");return 1===a?(n=e,e=o=void 0):2!==a||e.getContext||(o=n,n=e,e=void 0),new Promise((function(r,i){try{const i=it.create(n,o);r(t(i,e,o))}catch(t){i(t)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(i=n,n=e,e=o=void 0):3===a&&(e.getContext&&void 0===i?(i=o,o=void 0):(i=o,o=n,n=e,e=void 0));try{const r=it.create(n,o);i(null,t(r,e,o))}catch(t){i(t)}}Pe.render,Pe.renderToDataURL;var Be={create:it.create,toCanvas:Ce.bind(null,Pe.render),toDataURL:Ce.bind(null,Pe.renderToDataURL),toString:Ce.bind(null,(function(t,e,n){return Te(t,n)}))};function Ie(t,e,n){if(void 0===t)throw new Error("String required as first argument");if(void 0===n&&(n=e,e={}),"function"!=typeof n){if(!r())throw new Error("Callback required as last argument");e=n||{},n=null}return{opts:e,cb:n}}function Me(t){switch(t){case"svg":return Re;case"txt":case"utf8":return ce;default:return ae}}function Ue(t,e,n){if(!n.cb)return new Promise((function(r,o){try{const i=it.create(e,n.opts);return t(i,n.opts,(function(t,e){return t?o(t):r(e)}))}catch(t){o(t)}}));try{const r=it.create(e,n.opts);return t(r,n.opts,n.cb)}catch(t){n.cb(t)}}var Se,_e={create:it.create,toCanvas:Be.toCanvas,toString:function(t,e,n){const r=Ie(t,e,n),o=function(t){switch(t){case"svg":return Re;case"terminal":return Ee;default:return ce}}(r.opts?r.opts.type:void 0);return Ue(o.render,t,r)},toDataURL:function(t,e,n){const r=Ie(t,e,n);return Ue(Me(r.opts.type).renderToDataURL,t,r)},toBuffer:function(t,e,n){const r=Ie(t,e,n);return Ue(Me(r.opts.type).renderToBuffer,t,r)},toFile:function(t,e,n,o){if("string"!=typeof t||"string"!=typeof e&&"object"!=typeof e)throw new Error("Invalid argument");if(arguments.length<3&&!r())throw new Error("Too few arguments provided");const i=Ie(e,n,o),s=i.opts.type||function(t){return t.slice(2+(t.lastIndexOf(".")-1>>>0)).toLowerCase()}(t);return Ue(Me(s).renderToFile.bind(null,t),e,i)},toFileStream:function(t,e,n){if(arguments.length<2)throw new Error("Too few arguments provided");const r=Ie(e,n,t.emit.bind(t,"error"));Ue(Me("png").renderToFileStream.bind(null,t),e,r)}},Le=(Se=_e.toCanvas,function(){var t=Array.prototype.slice.call(arguments);return new Promise((function(e,n){t.push((function(t,r){t?n(t):e(r)})),Se.apply(null,t)}))}),Ne=function(t,e){var n=document.createElement("canvas");return Le(n,t,e).then((function(){return n.width}))},xe=function(t){return t.length>36?"M":t.length>16?"Q":"H"},De=function(t){var e=t.canvas,r=t.logo;if(!r)return Promise.resolve();if(""===r)return Promise.resolve();var o=e.width;n(r)&&(r={src:r});var i=r,s=i.logoSize,a=void 0===s?.15:s,u=i.borderColor,f=void 0===u?"#ffffff":u,c=i.bgColor,h=void 0===c?f||"#ffffff":c,l=i.borderSize,g=void 0===l?.05:l,d=i.crossOrigin,p=i.borderRadius,w=void 0===p?8:p,y=i.logoRadius,v=void 0===y?0:y,m="string"==typeof r?r:r.src,E=o*a,A=o*(1-a)/2,b=o*(a+g),T=o*(1-a-g)/2,R=e.getContext("2d");Ye(R)(T,T,b,b,w),R.fillStyle=h,R.fill();var P=new Image;P.setAttribute("crossOrigin",d||"anonymous"),P.src=m;return new Promise((function(t){P.onload=function(){v?function(t){var e=document.createElement("canvas");e.width=A+E,e.height=A+E,e.getContext("2d").drawImage(t,A,A,E,E),Ye(R)(A,A,E,E,v),R.fillStyle=R.createPattern(e,"no-repeat"),R.fill()}(P):function(t){R.drawImage(t,A,A,E,E)}(P),t()}}))},Ye=function(t){return function(e,n,r,o,i){var s=Math.min(r,o);return i>s/2&&(i=s/2),t.beginPath(),t.moveTo(e+i,n),t.arcTo(e+r,n,e+r,n+o,i),t.arcTo(e+r,n+o,e,n+o,i),t.arcTo(e,n+o,e,n,i),t.arcTo(e,n,e+r,n,i),t.closePath(),t}},Oe=function(t){return function(t){var e=t.canvas,n=t.content,r=t.width,o=void 0===r?0:r,i=t.nodeQrCodeOptions,s=void 0===i?{}:i;return s.errorCorrectionLevel=s.errorCorrectionLevel||xe(n),Ne(n,s).then((function(t){return s.scale=0===o?void 0:o/t*4,Le(e,n,s)}))}(t).then((function(){return De(t)}))},ke=function(r){return t(this,void 0,void 0,(function(){var t,o,i,s,a,u;return e(this,(function(e){switch(e.label){case 0:return t=r.canvas,r.logo&&(n(r.logo)&&(r.logo={src:r.logo}),r.logo.crossOrigin="Anonymous"),this.ifCanvasDrawed?[3,2]:[4,Oe(r)];case 1:e.sent(),e.label=2;case 2:if(o=r.image,i=r.downloadName,s=void 0===i?"qr-code":i,a=r.download,!t.toDataURL())throw new Error("Can not get the canvas DataURL");return o.src=t.toDataURL(),this.ifImageCreated=!0,!0!==a&&"function"!=typeof a?[2]:(u=function(){Fe(o,s)},(a=!0===a?function(t){return t()}:a)&&a(u),[2,Promise.resolve()])}}))}))},Fe=function(t,e){var n=t.src,r=document.createElement("a");r.download=e,r.href=n,r.dispatchEvent(new MouseEvent("click"))},ze=function(t,e){for(var n=t.src.split(","),r=n[0].match(/:(.*?);/)[1],o=atob(n[1]),i=o.length,s=new Uint8Array(i);i--;)s[i]=o.charCodeAt(i);return new File([s],e,{type:r})};return function(){function n(t){this.ifCanvasDrawed=!1,this.ifImageCreated=!1,this.defaultOption={canvas:document.createElement("canvas"),image:new Image,content:""},this.option=Object.assign(this.defaultOption,t),this.option.canvas||(this.option.canvas=document.createElement("canvas")),this.option.image||(this.option.image=document.createElement("img"))}return n.prototype.toCanvas=function(){var t=this;return Oe.call(this,this.option).then((function(){return t.ifCanvasDrawed=!0,Promise.resolve()}))},n.prototype.toImage=function(){return ke.call(this,this.option)},n.prototype.downloadImage=function(n){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return this.ifImageCreated?[3,2]:[4,this.toImage()];case 1:t.sent(),t.label=2;case 2:return Fe(this.option.image,n),[2]}}))}))},n.prototype.getFile=function(n){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return this.ifImageCreated?[3,2]:[4,this.toImage()];case 1:t.sent(),t.label=2;case 2:return[2,ze(this.option.image,n)]}}))}))},n.prototype.getCanvas=function(){return t(this,void 0,Promise,(function(){return e(this,(function(t){switch(t.label){case 0:return this.ifCanvasDrawed?[3,2]:[4,this.toCanvas()];case 1:t.sent(),t.label=2;case 2:return[2,this.option.canvas]}}))}))},n.version="1.0.4",n}()}));
